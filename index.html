<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="UTF-8">
  <title>Future Park</title>
  <link rel="stylesheet" href="/stylesheets/bootstrap.min.css">
  <link rel="stylesheet" href="/stylesheets/bootstrap-theme.min.css">
  <script src="/stylesheets/jquery-3.1.0.min.js"></script>
  <script src="/libs/exceed.lib.js"></script>

  <script src="http://code.jquery.com/jquery-latest.min.js"></script>
  <link type="text/css" rel="stylesheet" href="css/materialize.min.css"  media="screen,projection"/>
  <script type="text/javascript" src="js/materialize.min.js"></script>
  <link href="http://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link rel="stylesheet" href="./index.css">
  <script src="./jquery-circle-progress-1.1.3/dist/circle-progress.js"></script>
  <script type="text/javascript" src="./canvasjs.min.js"></script>
  <script src="http://canvasjs.com/assets/script/canvasjs.min.js"></script>
  <script type="text/javascript">
  window.onload = function () {
    var chart = new CanvasJS.Chart("chartContainer",
    {
      animationEnabled: true,
      title:{
        text: "The best amount of each products in Future Park"
      },
      data: [
        {
          type: "column",
          dataPoints: [
            { label: "Banana", y: 60 },
            { label: "Chilli", y: 60 },
            { label: "Basil",  y: 10 },
            { label: "Cucumber",  y: 80 },
            { label: "Watermelon",  y: 100 }
          ]
        }
      ]
    });

    chart.render();
  }
  </script>


</head>

<body>

  <div id = "title" class="row">
    <nav>
      <div class="nav-wrapper">
        <a href="#" class="brand-logo center">
          <font face="verdana" class="set-font">Future Park</font>
        </a>
        <ul id="nav-mobile" class="left hide-on-med-and-down">
        </ul>
      </div>
    </nav>
  </div>


  <div class="col s12">
    <ul class="tabs">
      <li class="tab col s3"><a class="active" href="#test1">Controls</a></li>
      <li class="tab col s3"><a  href="#test2">Suggestion</a></li>
    </ul>
    <div id="test1" class="col s12">
      <div class="panel-body">
        <div class = "col-md-12 col-sm-12 col-xs-12 btn-row">
          <div class="caption left-align">
            <div class = "col-md-3 col-sm-3 col-xs-3 center home-btn">
              <div>
                <div class = "col-md-12 col-sm-12 col-xs-12">
                  <button type="button" id = "btn-moisture" class = "btn-floating waves-effect waves-light btn tooltipped" data-delay="50" data-tooltip="Moisture" data-position="top">
                    <div id="moistSpan"hidden></div>
                    <img id = "moistureImg" src="./src/Pic/Measurement.png" alt="Measurement" style="width:50%;height:50%;"/>
                  </button>
                </div>
              </div>
            </div>
            <div class = "col-md-3 col-sm-3 col-xs-3 center home-btn">
              <div>
                <div class = "col-md-12 col-sm-12 col-xs-12">
                  <button type="button" id = "btn-temp" class = "btn-floating waves-effect waves-light btn tooltipped" data-delay="50" data-tooltip="Temperature" data-position="top">
                    <div id="tempSpan"hidden></div>
                    <img id = "tempImg" src="./src/Pic/Temperature_icon.png" alt="Temp" style="width:50%;height:50%;">
                  </button>
                </div>
              </div>
            </div>
            <div class = "col-md-3 col-sm-3 col-xs-3 center home-btn">
              <div>
                <div class = "col-md-12 col-sm-12 col-xs-12 center">
                  <button type="button" id = "btn-sunshine" class = "btn-floating waves-effect waves-light btn tooltipped" data-delay="50" data-tooltip="Sunshine" data-position="top">
                    <img id = "sunshineImg" src="./src/Pic/sun.png" alt="Sun" style="width:50%;height:50%;">
                  </button>
                </div>
              </div>
            </div>
            <div class = "col-md-3 col-sm-3 col-xs-3 center home-btn">
              <div>
                <div class = "col-md-12 col-sm-12 col-xs-12">
                  <button type="button" id = "btn-Light" class = "btn-floating waves-effect waves-light btn tooltipped" data-delay="50" data-tooltip=Light data-position="top">
                    <img hidden id="lightonImg" src="https://s31.postimg.org/jo4hyhzff/light2.png" style="width:70%;height:70%;">
                    <img id = "lightoffImg" src="https://s31.postimg.org/j3uit8x6j/Elertus_Icon_Light_On_1.png" alt="Light" style="width:60%;height:60%;">
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class = "col-md-12 col-sm-12 col-xs-12 btn-row">
          <div class = "col-md-3 col-sm-3 col-xs-3 center home-btn">
            <div>
              <div class = "col-md-12 col-sm-12 col-xs-12">
                <button type="button" id = "btn-motionAlert" class = "btn-floating waves-effect waves-light btn tooltipped" data-delay="50" data-tooltip="Motion Alert" data-position="top">
                  <img hidden id="alertonImg" src="https://s31.postimg.org/ab9o2benv/image.png" style="width:70%;height:70%;">
                  <img id = "alertoffImg" src="./src/Pic/motion1.png" alt="Roof" style="width:70%;height:70%;">
                  <img hidden id = "alertoffImg"src="https://s31.postimg.org/4xqo9tse3/motiongif.gif"  style="width:70%;height:70%;">
                </button>
              </div>
            </div>
          </div>
          <div class = "col-md-3 col-sm-3 col-xs-3 center home-btn">
            <div>
              <div class = "col-md-12 col-sm-12 col-xs-12">
                <button type="button" id = "btn-roof" class = "btn-floating waves-effect waves-light btn tooltipped" data-delay="50" data-tooltip="Roof" data-position="top">
                  <img hidden id="roofonImg" src="https://s32.postimg.org/hqb8xg6ad/Emoji_u2614_svg.png" style="width:50%;height:50%;">
                  <img id = "roofoffImg" src="./src/Pic/roof_off.png" alt="Roof" style="width:50%;height:50%;">
                </button>
              </div>
            </div>
          </div>
          <div class = "col-md-3 col-sm-3 col-xs-3 center home-btn">
            <div>
              <div class = "col-md-12 col-sm-12 col-xs-12">
                <button type="button"  id = "btn-water" class = "btn-floating waves-effect waves-light btn tooltipped" data-delay="50" data-tooltip="Water" data-position="top">
                  <img hidden id="wateronImg" src="https://s32.postimg.org/uf09wajk5/Water_Drop_Icon_Vector.png" style="width:40%;height:70%;">
                  <img id = "wateroffImg" src="./src/Pic/Water_Drop.png" alt="Water" style="width:40%;height:70%;">
                </button>
              </div>
            </div>
          </div>
          <div class = "col-md-3 col-sm-3 col-xs-3 center home-btn">
            <div>
              <div class = "col-md-12 col-sm-12 col-xs-12">
                <button type="button" id = "btn-refresh" class = "btn-floating waves-effect waves-light btn tooltipped" data-delay="50" data-tooltip="Refresh" data-position="top">
                  <img id = "refreshImg" src="./src/Pic/refresh.png" alt="Refresh" style="width:50%;height:50%;">
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div id="test2" class="col s12">
      <div class="slider" style = "width:100%;">
        <ul class="slides">
          <li>
              <div class = "col-md-4 col-sm-4 col-xs-4">
                <div class="card medium">
                  <div class="card-image waves-effect waves-block waves-light">
                    <img class="activator" src="./src/Pic/banana.jpg" style="width:400px; height:230px">
                  </div>
                  <div class="card-content">
                    <span class="card-title activator grey-text text-darken-4">Banana<i class="material-icons right">more_vert</i></span>
                  </div>
                  <div class="card-reveal">
                    <span class="card-title grey-text text-darken-4">Banana<i class="material-icons right">close</i></span>
                    <p>Banana is a tropical fruit. It hardly resists to the windy. Soils for bananas should be fertile mold ,and should drainage air and water well. While farming bananas, you might ponder about the sun shine and the soil. Stop watering if it’s raining on that day.</p>
                    <p>watering : 20 L./day suitable temperature: 15-30 degrees celsius sunlight: wanted product: after farming 8-10 months / well done in 70-80 days</p>
                  </div>
                </div>
              </div>
              <div class = "col-md-4 col-sm-4 col-xs-4">
                <div class="card medium">
                  <div class="card-image waves-effect waves-block waves-light">
                    <img class="activator" src="./src/Pic/watermelon2.jpg" style="width:400px; height:230px">
                  </div>
                  <div class="card-content">
                    <span class="card-title activator grey-text text-darken-4">Water melon<i class="material-icons right">more_vert</i></span>
                  </div>
                  <div class="card-reveal">
                    <span class="card-title grey-text text-darken-4">Water melon<i class="material-icons right">close</i></span>
                    <p>Watermelon grows well in loamy sand soil and well drainage. For detecting dry clay, you should water it everyday. At the end of rainy season, the amount of products would be lesser than in other months.</p>
                    <p>watering : 10 L./day suitable temperature: 20-35 degrees celsius sunlight: wanted product: after fruit bearing 45 days</p>
                  </div>
                </div>
              </div>
              <div class = "col-md-4 col-sm-4 col-xs-4">
                <div class="card medium">
                  <div class="card-image waves-effect waves-block waves-light">
                    <img class="activator" src="./src/Pic/chilli.jpg" style="width:400px; height:240px">
                  </div>
                  <div class="card-content">
                    <span class="card-title activator grey-text text-darken-4">Chilli<i class="material-icons right">more_vert</i></span>
                  </div>
                  <div class="card-reveal">
                    <span class="card-title grey-text text-darken-4">Chilli<i class="material-icons right">close</i></span>
                    <p>Chillie is a vegetable that can grow well in the hot and dry weather, but can’t grow in the cold weather. Chile requires averagely watering and loamy sand soil. Otherwise it would be died when the soil cannot drainage.</p>
                    <p>watering : 1.6 L./day suitable temperature: more over 35 degrees celsius sunlight: wanted product: after farming 4-6 months</p>
                  </div>
                </div>
            </div>
          </li>
          <li>
            <div class="caption left-align">
              <div class="row">
                <div id="chartContainer" style="height: 300px; width: 100%;">
                </div>
              </div>
            </div>
          </li>
        </ul>
      </div>
    </div>

  </div>


  <script type='text/javascript'>
  $(document).ready(function(){
    $('ul.tabs').tabs();
  });
  $(document).ready(function(){
    $('.slider').slider({interval: 100000000000000000000});
  });
  $(document).ready(function() {
    Materialize.updateTextFields();
  });
  var moistureStatus = 0;
  var moistureActivate = false;
  var tempStatus = 0;
  var tempActivate = false;
  var lightStatus = 'lightoff';
  var lightActivate = false;
  var sunStatus = 'light';
  var waterStatus = '0';
  var waterActivate = false;
  var motionActivate = false;
  var motionStatus = '0';
  var roofStatus = '0';
  var roofActivate = false;
  var refreshStatus = 0;
  var oldMessage = '0,0,0,0';
  document.getElementById("btn-moisture").addEventListener("click", moistureStatusAction);
  document.getElementById("btn-water").addEventListener("click", waterStatusByClick);
  document.getElementById("btn-Light").addEventListener("click", lightStatusByClick);
  document.getElementById("btn-motionAlert").addEventListener("click", motionStatusByClick);
  document.getElementById("btn-roof").addEventListener("click", roofStatusByClick);
  document.getElementById("btn-temp").addEventListener("click", tempStatusAction);
  setInterval(function(){
    $.ajax({
      url:'http://10.32.176.4/expecto_patronum'
    })
    .done(function(data){
      var str = data;
      var res = str.split(",");
      moistureStatus = res[0];
      sunStatus = res[1];
      sunStatusAuto();
      tempStatus = res[2];
      $('#hiddentemp').removeAttr("hidden");
      if(!lightActivate){
        lightStatus = res[3];
        lightStatusAuto();
      }
      if(motionActivate){
        motionStatus = res[4];
        motionStatusAuto();
      }
      if(!roofActivate){
        roofStatus = res[5];
        roofStatusAuto();
      }
      if(!waterActivate){
        waterStatus = res[6];
        waterStatusAuto();
      }
    });
  },1000);
  function moistureStatusAction() {
    if(!moistureActivate) {
      $('#moistureImg').attr("hidden","");
      $('#moistSpan').circleProgress({
        value: moistureStatus/100.00,
        size: 140,
        startAngle : -3.14/2,
        fill: {
          gradient: [['#D2527F', .5], ['#BF55EC', .5]], gradientAngle: Math.PI*2
        }
      });
      $('#moistSpan').on('circle-animation-progress', function(e, v) {
        var obj = $(this).data('circle-progress'),
        ctx = obj.ctx,
        s= obj.size,
        sv = (motionStatus * v ).toFixed(),
        fill = obj.arcFill;
        ctx.save();
        ctx.font = "bold " + s /  4 + 'px sans-serif';
        ctx.textAlign = 'center';
        ctx.textBaseline = 'middle';
        ctx.fillStyle = fill;
        ctx.fillText(sv, s/2, s/2);
        ctx.restore();
      });
      $('#moistSpan').removeAttr("hidden");
      moistureActivate = true
    }else {
      $('#moistureImg').removeAttr("hidden");
      $('#moistSpan').attr("hidden","");
      moistureActivate = false;
    }
  }
  function sunStatusAuto() {
    if(sunStatus === '1') {
      $('#sunImg').attr("hidden","");
      $('#rainImg').attr("hidden","");
      $('#moonImg').removeAttr("hidden");
    }else if(sunStatus == '2') {
      $('#rainImg').removeAttr("hidden");
      $('#moonImg').attr("hidden","");
      $('#sunImg').attr("hidden","");
    }else if (sunStatus == '0') {
      $('#sunImg').removeAttr("hidden");
      $('#rainImg').attr("hidden","");
      $('#moonImg').attr("hidden","");
    }
  }
  function tempStatusAction() {
    if(!tempActivate) {
      $('#tempImg').attr("hidden","");
      $('#tempSpan').circleProgress({
        value: (tempStatus)/100.00,
        size: 140,
        startAngle : -3.14/2,
        fill: {
          gradient: [['#D2527F', .5], ['#BF55EC', .5]], gradientAngle: Math.PI*2
        }
      });
      $('#tempSpan').on('circle-animation-progress', function(e, v) {
        var obj = $(this).data('circle-progress'),
        ctx = obj.ctx,
        s= obj.size,
        sv = (tempStatus * v ).toFixed(),
        fill = obj.arcFill;
        ctx.save();
        ctx.font = "bold " + s /  4 + 'px sans-serif';
        ctx.textAlign = 'center';
        ctx.textBaseline = 'middle';
        ctx.fillStyle = fill;
        ctx.fillText(sv+"°C", s/2, s/2);
        ctx.restore();
      });
      $('#tempSpan').removeAttr("hidden");
      tempActivate = true
    }else {
      $('#tempImg').removeAttr("hidden");
      $('#tempSpan').attr("hidden","");
      tempActivate = false;
    }
  }
  function lightStatusByClick() {
    if(!lightActivate) {
      sendMessage(1,1);
      $('#lightoffImg').attr("hidden","");
      $('#lightonImg').removeAttr("hidden");
      lightActivate = true;
    }else{
      sendMessage(1,0);
      $('#lightoffImg').removeAttr("hidden");
      $('#lightonImg').attr("hidden","");
      lightActivate = false;
    }
  }
  function lightStatusAuto() {
    if(lightStatus === '1') {
      $('#lightoffImg').attr("hidden","");
      $('#lightonImg').removeAttr("hidden");
    }else {
      $('#lightoffImg').removeAttr("hidden");
      $('#lightonImg').attr("hidden","");
    }
  }
  function motionStatusByClick() {
    if(!motionActivate){
      sendMessage(3,1);
      $('#alertoffImg').attr("hidden","");
      $('#alertonImg').removeAttr("hidden");
      motionActivate = true;
    }else {
      sendMessage(3,0);
      $('#alertoffImg').removeAttr("hidden");
      $('#alertonImg').attr("hidden","");
      motionActivate = false;
    }
  }
  function motionStatusAuto() {
      if(motionStatus === '1') {
        $('#alertonImg').removeAttr("hidden");
        $('#alertImg').attr("hidden","");
      }else if(motionStatus === '2') {
        $('#alertImg').removeAttr("hidden");
        $('#alertonImg').attr("hidden","");
      }
    }
  function roofStatusByClick() {
    if(!roofActivate) {
      sendMessage(5,1);
      $('#roofoffImg').attr("hidden","");
      $('#roofonImg').removeAttr("hidden");
      roofActivate = true;
    }else {
      sendMessage(5,0);
      $('#roofoffImg').removeAttr("hidden");
      $('#roofonImg').attr("hidden","");
      roofActivate = false;
    }
  }
  function roofStatusAuto() {
    if(roofStatus === '0') {
      $('#roofoffImg').attr("hidden","");
      $('#roofonImg').removeAttr("hidden");
    }else {
      $('#roofoffImg').removeAttr("hidden");
      $('#roofonImg').attr("hidden","");
    }
  }
  function waterStatusByClick() {
    if(!waterActivate) {
      sendMessage(7,1);
      $('#wateroffImg').attr("hidden","");
      $('#wateronImg').removeAttr("hidden");
      waterActivate = true;
    }else {
      sendMessage(7,0);
      $('#wateroffImg').removeAttr("hidden");
      $('#wateronImg').attr("hidden","");
      waterActivate = false;
    }
  }
  function waterStatusAuto() {
    if(waterStatus === '0') {
      $('#wateroffImg').attr("hidden","");
      $('#wateronImg').removeAttr("hidden");
    }else {
      $('#wateroffImg').removeAttr("hidden");
      $('#wateronImg').attr("hidden","");
    }
  }
  function sendMessage(order,data){
    var res = oldMessage.substring(0, order-1)+data+oldMessage.substring(order);
    oldMessage = res;
    console.log(res);
    $.ajax({
      url:'http://10.32.176.4/expecto_patronum/'+res
    })
  }
  $( document ).ready(function() {
    $(".setsize").each(function() {
      $(this).height($(this).width());
    });
  });
  $(window).on('resize', function(){
    $(".setsize").each(function() {
      $(this).height($(this).width());
    });
  });
  </script>
</body>

</html>
